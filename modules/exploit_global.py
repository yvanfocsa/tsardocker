# modules/exploit_global.py
import shlex

MODULE = {
    "name":        "Exploitation â€“ Complet",
    "description": "searchsploit, metasploit, sqlmap et hydra",
    "category":    "Exploitation",
    "hidden":      False,
    "schema": [
        {"name": "target", "type": "string", "placeholder": "exemple.com ou 1.2.3.4", "required": True},
        {"name": "mode",   "type": "select", "choices": ["quick", "full"], "default": "quick"},
    ],
    "cmd": lambda p: {
        "quick": [
            "bash", "-c",
            " && ".join([
                f"searchsploit {shlex.quote(p['target'])} || true",
                f"sqlmap -u http://{shlex.quote(p['target'])} --batch || true",
            ])
        ],
        "full": [
            "bash", "-c",
            " && ".join([
                f"searchsploit {shlex.quote(p['target'])} || true",
                f"msfconsole -q -x \"use exploit/multi/handler; set RHOST {shlex.quote(p['target'])}; run\" || true",
                f"sqlmap -u http://{shlex.quote(p['target'])} --batch || true",
                f"hydra -L users.txt -P passwords.txt {shlex.quote(p['target'])} ssh || true",
            ])
        ],
    }[p["mode"]],
}
