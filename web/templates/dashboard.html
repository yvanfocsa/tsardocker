{% extends "base.html" %}
{% block content %}

<!-- ===== MÉTRIQUES SYSTÈME ===== -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
  {# RAM via HTMX, rafraîchie toutes les 3 s #}
  <div
    hx-get="{{ url_for('routes.metrics_ram') }}"
    hx-trigger="load, every 3s"
    hx-swap="innerHTML"
    class="bg-translucent p-5 rounded-lg shadow-md border-l-4 border-[var(--tsar-accent)]"
  >
    RAM…
  </div>

  {# Les autres métriques #}
  {% for label, val in metrics.items() if label != 'RAM utilisée' %}
  <div class="bg-translucent p-5 rounded-lg shadow-md border-l-4 border-[var(--tsar-accent)]">
    <p class="text-xs uppercase text-gray-400 tracking-wider">{{ label }}</p>
    <p class="text-2xl font-semibold mt-1">{{ val }}</p>
  </div>
  {% endfor %}
</div>


<!-- ===== FAVORIS ===== -->
<div class="bg-translucent p-6 rounded-lg shadow-md mb-8">
  <h2 class="text-xl font-semibold mb-4">Favoris</h2>

  {% if favoris %}
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
    {% for m in favoris %}
    <a href="{{ url_for('routes.module_live', name=m.name) }}"
       class="fav-card block bg-translucent p-5 rounded-lg shadow-inner"
    >
      <h3 class="font-semibold text-lg text-[var(--tsar-text)]">{{ m.name }}</h3>
      <p class="text-gray-400 text-sm mt-1">{{ m.description }}</p>
    </a>
    {% endfor %}
  </div>
  {% else %}
    <p class="text-gray-400">Aucun favori. Ajoutez-en via les modules (☆).</p>
  {% endif %}
</div>


<!-- ===== HISTORIQUE ===== -->
<div class="bg-translucent p-6 rounded-lg shadow-md">
  <h2 class="text-xl font-semibold mb-4">Historique (10 dernières actions)</h2>

  {% if logs %}
  <ul class="space-y-3">
    {% for entry in logs %}
    <li class="flex justify-between items-start">
      <div class="space-y-1">
        <div class="text-[var(--tsar-text)]">
          <span class="font-medium">{{ entry.module }}</span>
          {% if entry.target %}
            sur <code class="bg-[#111] px-1 rounded">{{ entry.target }}</code>
          {% endif %}
          ({{ entry.mode }})
        </div>
        <div class="text-gray-400 text-sm">
          {{ entry.created_at.strftime('%Y-%m-%d %H:%M:%S') }}
        </div>
      </div>
    </li>
    {% endfor %}
  </ul>
  {% else %}
    <p class="text-gray-400">Aucune action récente.</p>
  {% endif %}
</div>

{% endblock %}

